"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),ACTIONS={create:"create",remove:"remove"},PressAndHold=function(){function e(t){if(_classCallCheck(this,e),void 0===t.duration)throw new Error("pressAndHold configuration error: A duration is required to instantiate");if(void 0===t.keyCode&&void 0===this.mouseButton)throw new Error("pressAndHold configuration error: A keyCode or mousebutton is required to instantiate");var n={interval:1,onStart:function(){},onSuccess:function(){},onCancel:function(){},onTick:function(){}};Object.assign(this,n,t),this.completed=!1,this.timer=null,this.eventStart=this.eventStart.bind(this),this.eventEnd=this.eventEnd.bind(this),this.handleListeners(ACTIONS.create)}return _createClass(e,[{key:"eventStart",value:function(e){var t=this;e=e||window.event,!this.matchPredicate(e)||this.timer||this.completed||!function(){t.onStart(e);var n=t.initTimer(t.duration);t.timer=setInterval(function(){return t.pollTimer(n)},t.interval)}()}},{key:"eventEnd",value:function(e){e=e||window.event,this.matchPredicate(e)&&(this.resetTimer(),this.completed||this.onCancel(e),this.completed=!1)}},{key:"initTimer",value:function(e){var t=Date.now();return{startTime:t,timeRequired:e,endTime:t+e}}},{key:"pollTimer",value:function(e){var t=Date.now(),n=t-e.startTime,i=e.endTime-t;t>=e.endTime?(this.resetTimer(),this.completed=!0,this.onSuccess(),this.keepAlive||this.handleListeners(ACTIONS.remove)):this.onTick(n,i,n/e.timeRequired)}},{key:"resetTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"matchPredicate",value:function(e){return e.type.includes("key")?(e.which||e.keyCode)===this.keyCode:e.type.includes("mouse")?e.button===this.mouseButton:void 0}},{key:"handleListeners",value:function(e){var t=e===ACTIONS.create?document.addEventListener:document.removeEventListener;void 0!==this.keyCode&&(t("keydown",this.eventStart),t("keyup",this.eventEnd)),void 0!==this.mouseButton&&(t("mousedown",this.eventStart),t("mouseup",this.eventEnd))}}]),e}();